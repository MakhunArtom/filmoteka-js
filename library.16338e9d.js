const e={overlay:document.querySelector(".modal-footer-overlay"),modalFooter:document.querySelector(".modal-footer"),modalBtnClose:document.querySelector(".js-modal-close")};function t(e){"Escape"===e.code&&n()}function n(){document.querySelector(".modal-footer.active").classList.remove("active"),document.querySelector(".modal-footer-overlay").classList.remove("active"),document.body.classList.remove("modal-is-open")}var a={save:(e,t)=>{try{const n=JSON.stringify(t);localStorage.setItem(e,n)}catch(t){console.log(`Error during saving ${e} to local strage; `,t.message)}},load:e=>{try{const t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(t){console.log(`Error during getting ${e} from localStorage: `,t.message)}},del:e=>{try{localStorage.removeItem(e)}catch(t){console.log(`Error during deleting ${e}! from localStorage: `,t.message)}}};function o(e){const t=document.querySelector(".filmoteka__container"),n=e.map((({id:e,title:t,year:n,genres:a,rating:o,imgPath:l})=>{if(a){let e=(a.match(/\,/g)||[]).length;for(;e>1;)e=((a=a.slice(0,a.lastIndexOf(","))+"npm ...").match(/\,/g)||[]).length}let d=`\n         <div class="filmoteka__item" data-id="${e}">\n              <div class="filmoteka__item-wrapper">\n                  <img class="filmoteka-img" src="${l}" alt="">\n                  <div class="overlay-text">\n                      <h2 class="subtitle">${t}</h2>\n                      <p class="discription">`;return a&&(d+=`${a} `,n&&(d+="|")),n&&(d+=`<span class="filmoteka__year"> ${n}</span>`),d+=` </p>\n                      <div class="filmoteka__rating">${o}</div>\n                  </div>\n              </div>\n      </div>`,d}));t.innerHTML="",t.insertAdjacentHTML("beforeend",n.join(""))}function l(e){const t=document.querySelector(".filmoteka__container");let n=a.load(e);n?o(n):t.innerHTML='<div><p2 class="empty_text">It seems that there is no films here!</p2></div>'}function d(e,t){let n=a.load(t).filter((t=>t.id!==+e));n=n.length>0?n:null,a.save(t,n)}function s(e,t){let n=a.load(t);let o=a.load("currentPage").find((t=>t.id==e));n?n.push(o):n=[o],a.save(t,n)}let c=document.querySelector(".cross");const i=document.querySelector(".backdrop"),r=document.querySelector(".modal-container");function u(e){const t=e.target.dataset.id,n=document.querySelector(".js-watch");if(!n.classList.contains("watched"))return s(t,"watched"),n.classList.add("watched"),n.innerText="WATCHED",void v();n.classList.remove("watched"),n.innerText="ADD TO WATCHED",d(t,"watched"),v()}function m(e){const t=e.target.dataset.id,n=document.querySelector(".js-queue");if(!n.classList.contains("queued"))return s(t,"queued"),n.classList.add("queued"),n.innerText="QUEUED",void v();n.classList.remove("queued"),n.innerText="ADD TO QUEUE",d(t,"queued"),v()}function v(){if(window.location.href.indexOf("library")>-1){l(document.querySelector("#btnQueued").classList.contains("active-btn")?"queued":"watched")}}function b(){i.classList.add("visually-hidden"),document.body.style.overflow="",i.removeEventListener("click",p),c.removeEventListener("click",b),window.removeEventListener("keydown",f),r.innerHTML='<button type="button" class="cross">+</button>'}function f(e){"Escape"===e.code&&b()}function p(e){e.target.classList.contains("backdrop")&&b()}const y={btnWatched:document.querySelector("#btnWatched"),btnQueued:document.querySelector("#btnQueued"),mainContainer:document.querySelector(".filmoteka__container"),openModalBtn:document.querySelector(".modal-footer-open"),mainContainer:document.querySelector(".filmoteka__container")};l("watched"),y.btnQueued.addEventListener("click",(function(){y.btnWatched.classList.remove("active-btn"),y.btnQueued.classList.add("active-btn"),l("queued")})),y.btnWatched.addEventListener("click",(function(){y.btnQueued.classList.remove("active-btn"),y.btnWatched.classList.add("active-btn"),l("watched")})),y.mainContainer.addEventListener("click",(function(e){if(!e.target.classList.contains("filmoteka__item"))return;!function(e){const t=a.load("currentPage").find((t=>t.id===e)),{id:n,title:o,originalTitle:l,genres:d,popularity:s,overview:c,rating:i,voteCount:v,imgPath:b}=t,f=`\n  <div class="modal-img-container">\n  <img\n    class="modal-img"\n    src="${b}"\n    alt="${o}"\n    width="370"\n    height="470"\n  />\n</div>\n<div class="film-info">\n  <h2 class="film-name">${o}</h2>\n  <table class="modal-table">\n    <tr class="modal-table__row">\n      <td><p class="modal-table__attribute">Vote / Votes</p></td>\n      <td>\n        <p class="modal-table__value">\n          <span class="modal-table__vote">${i}</span> /\n          <span class="modal-table__votes">${v}</span>\n        </p>\n      </td>\n    </tr>\n    <tr class="modal-table__row">\n      <td><p class="modal-table__attribute">Popularity</p></td>\n      <td><p class="modal-table__value">${s}</p></td>\n    </tr>\n    <tr class="modal-table__row">\n      <td><p class="modal-table__attribute">Original Title</p></td>\n      <td><p class="modal-table__value">${l}</p></td>\n    </tr>\n    <tr class="modal-table__row">\n      <td><p class="modal-table__attribute">Genre</p></td>\n      <td><p class="modal-table__value">${d||""}</p></td>\n    </tr>\n  </table>\n\n  <h3 class="film-about">About</h3>\n  <p class="film-description">\n    ${c}\n  </p>\n  <div class="modal-btn-wrap">\n    <button type="button" class="modal-btn js-watch" data-id="${n}">ADD TO WATCHED</button>\n    <button type="button" class="modal-btn js-queue" data-id="${n}">ADD TO QUEUE</button>\n  </div>\n</div>`;r.insertAdjacentHTML("beforeend",f),function(e){const t=document.querySelector(".js-watch"),n=document.querySelector(".js-queue");let o,l;t.addEventListener("click",u),n.addEventListener("click",m);let d=a.load("watched"),s=a.load("queued");d&&(l=!!d.find((t=>t.id==e)));s&&(o=!!s.find((t=>t.id==e)));l&&(t.classList.add("watched"),t.innerText="WATCHED");o&&(n.classList.add("queued"),n.innerText="QUEUED")}(e)}(+e.target.dataset.id),i.classList.remove("visually-hidden"),document.body.style.overflow="hidden",c=document.querySelector(".cross"),c.addEventListener("click",b),i.addEventListener("click",p),window.addEventListener("keydown",f)})),y.openModalBtn.addEventListener("click",(function(){e.overlay.classList.add("active"),e.modalFooter.classList.add("active"),document.body.classList.add("modal-is-open"),document.body.addEventListener("keydown",t),e.overlay.addEventListener("click",n),e.modalBtnClose.addEventListener("click",n)}));
//# sourceMappingURL=library.16338e9d.js.map
